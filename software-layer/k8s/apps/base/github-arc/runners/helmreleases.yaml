---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: gha-runner-scale-set
spec:
  chartRef:
    kind: OCIRepository
    name: gha-runner-scale-set
  interval: 24h
  values:
    githubConfigUrl: https://github.com/bcbrookman/homeops
    githubConfigSecret: homeops-arc-app
    runnerScaleSetName: homeops-arc-runners
    minRunners: 0
    maxRunners: 5
    template:
      spec:
        containers:
          - name: runner
            image: ghcr.io/bcbrookman/homeops-cicd:latest
            command: ["/home/runner/run.sh"]
        dnsConfig:
          options:
            - name: ndots
              value: '1'
          searches:
            - home.bcbrookman.com
            - bcbrookman.com
